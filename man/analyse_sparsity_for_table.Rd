% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scht_sparsity.R
\name{analyse_sparsity_for_table}
\alias{analyse_sparsity_for_table}
\title{Comprehensive sparsity analysis for manuscript table}
\usage{
analyse_sparsity_for_table(
  gene_counts,
  transcript_counts,
  transcript_info,
  scht_obj,
  filtered_gene_counts = NULL,
  filtered_transcript_counts = NULL,
  dataset_name = "Dataset"
)
}
\arguments{
\item{gene_counts}{Original gene count matrix}

\item{transcript_counts}{Original transcript count matrix}

\item{transcript_info}{Transcript information data frame}

\item{scht_obj}{SCHT object created by create_scht}

\item{filtered_gene_counts}{Gene counts after QC (optional)}

\item{filtered_transcript_counts}{Transcript counts after QC (optional)}

\item{dataset_name}{Name of the dataset for reporting}
}
\value{
List containing comprehensive sparsity statistics at all levels
}
\description{
Generates comprehensive sparsity statistics matching the manuscript table format,
comparing original matrices, filtered matrices, theoretical tensor, and SCHT structure.
}
\examples{
# Load example data and create SCHT
data(gene_counts_blood)
data(transcript_counts_blood)
data(transcript_info)
data(sample2stage)

scht_obj <- create_scht(
  gene_counts = gene_counts_blood,
  transcript_counts = transcript_counts_blood,
  transcript_info = transcript_info,
  cell_info = sample2stage,
  qc_params = list(
    min_genes_per_cell = 4000,       
    max_genes_per_cell = 10000,      
    min_cells_expressing = 0.02,   
    min_expr = 1e-6
  ),
  n_hvg = 3000,
  verbose = FALSE
)

# Analyse sparsity across representations
results <- analyse_sparsity_for_table(
  gene_counts = gene_counts_blood,
  transcript_counts = transcript_counts_blood,
  transcript_info = transcript_info,
  scht_obj = scht_obj,
  dataset_name = "Blood Cell Data"
)

# Access specific statistics
print(paste("SCHT uses only", 
            round(results$scht$total / results$original$total * 100, 2),
            "\% of original matrix size"))
}
