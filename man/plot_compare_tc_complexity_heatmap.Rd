% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualisation_analysis.R
\name{plot_compare_tc_complexity_heatmap}
\alias{plot_compare_tc_complexity_heatmap}
\title{Create heatmaps for transcriptome complexity metrics across groups using ComplexHeatmap}
\usage{
plot_compare_tc_complexity_heatmap(
  tc_results_list,
  groups = NULL,
  metrics = c("intra_cellular_isoform_diversity", "inter_cellular_isoform_diversity",
    "intra_cell_type_heterogeneity", "inter_cell_type_specificity",
    "intra_cell_type_heterogeneity_variability",
    "inter_cell_type_difference_variability", "cell_type_coexpression_variability"),
  n_top_genes = 50,
  selection_method = "variance",
  custom_genes = NULL,
  cluster_genes = FALSE,
  show_changes = TRUE
)
}
\arguments{
\item{tc_results_list}{List of transcriptomic complexity results objects}

\item{groups}{Vector of names for each group (if NULL, generic names are used)}

\item{metrics}{Vector of metric names to include in heatmaps}

\item{n_top_genes}{Number of top genes to include in heatmaps}

\item{selection_method}{Method for selecting genes ("variance", "magnitude", or "custom")}

\item{custom_genes}{Vector of custom gene names to use when selection_method is "custom"}

\item{cluster_genes}{Whether to cluster genes in heatmaps}

\item{show_changes}{Whether to create separate heatmaps showing changes between groups}
}
\value{
A list containing:
\item{heatmaps}{List of ComplexHeatmap objects for each metric}
\item{change_heatmaps}{List of ComplexHeatmap objects showing changes between groups}
\item{metric_matrices}{List of matrices with metric values}
\item{change_matrices}{List of matrices with change values}
\item{top_genes}{Vector of selected gene names}
\item{selection_method}{Method used for gene selection}
}
\description{
This function creates heatmaps for visualising multiple complexity metrics
across different groups or conditions. It can also show changes in metrics
between consecutive groups. The function supports different methods for
selecting genes to display.
}
\examples{
\dontrun{
# This example requires multiple conditions/datasets  
data(gene_counts_blood)
data(transcript_counts_blood)
data(transcript_info)
data(sample2stage)

# Create SCHT
scht_obj <- create_scht(
  gene_counts = gene_counts_blood,
  transcript_counts = transcript_counts_blood,
  transcript_info = transcript_info,
  cell_info = sample2stage,
  qc_params = list(
    min_genes_per_cell = 4000,       
    max_genes_per_cell = 10000,      
    min_cells_expressing = 0.02,   
    min_expr = 1e-6
  ),
  n_hvg = 3000,
  verbose = FALSE
)

# Calculate metrics
tc_results <- calculate_isoform_complexity_metrics(scht_obj, verbose = FALSE)

# For demonstration, create a list with the same results
tc_results_list <- list(
  baseline = tc_results,
  treatment = tc_results  # In practice, these would be different
)
                        
# Create heatmaps with default settings
heatmap_results <- plot_compare_tc_complexity_heatmap(
  tc_results_list, 
  groups = c("Baseline", "Treatment")
)
                  
# Display the first heatmap if ComplexHeatmap is available
if(requireNamespace("ComplexHeatmap", quietly = TRUE)) {
  print(heatmap_results$heatmaps$intra_cellular_isoform_diversity)
}
}

}
