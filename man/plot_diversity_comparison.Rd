% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualisation_analysis.R
\name{plot_diversity_comparison}
\alias{plot_diversity_comparison}
\title{Dual diversity comparison plot}
\usage{
plot_diversity_comparison(
  tc_results,
  label_top = 10,
  point_transparency = 0.85,
  use_thresholds = TRUE,
  x_threshold = 0.6,
  y_threshold = 0.6
)
}
\arguments{
\item{tc_results}{Transcriptomic complexity results object or metrics data frame}

\item{label_top}{Number of top genes (by idi_difference) to label below the diagonal line}

\item{point_transparency}{Alpha value for points (0-1)}

\item{use_thresholds}{Whether to use thresholds from tc_results}

\item{x_threshold}{Threshold value for x-axis (intra-cellular diversity)}

\item{y_threshold}{Threshold value for y-axis (inter-cellular diversity)}
}
\value{
A ggplot object with the diversity comparison visualization that can be printed or saved
}
\description{
Visualises the relationship between intra-cellular and inter-cellular
diversity to identify different isoform usage patterns. This plot helps identify
genes with unusual patterns, particularly those with higher intra-cellular
than inter-cellular diversity.
}
\examples{
# Load example data and create SCHT
data(gene_counts_blood)
data(transcript_counts_blood)
data(transcript_info)
data(sample2stage)

scht_obj <- create_scht(
  gene_counts = gene_counts_blood,
  transcript_counts = transcript_counts_blood,
  transcript_info = transcript_info,
  cell_info = sample2stage,
  qc_params = list(
    min_genes_per_cell = 4000,       
    max_genes_per_cell = 10000,      
    min_cells_expressing = 0.02,   
    min_expr = 1e-6
  ),
  n_hvg = 3000,
  verbose = FALSE
)

# Calculate complexity metrics
tc_results <- calculate_isoform_complexity_metrics(scht_obj, verbose = FALSE)

# Create diversity comparison plot
plot_diversity_comparison(tc_results)

# Label more genes
plot_diversity_comparison(tc_results, label_top = 20)

# Adjust transparency and thresholds
plot_diversity_comparison(
  tc_results, 
  label_top = 15,
  point_transparency = 0.7,
  x_threshold = 0.5,
  y_threshold = 0.5
)

}
