% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/qc_utils.R
\name{plot_genes_per_cell_distribution}
\alias{plot_genes_per_cell_distribution}
\title{Plot and analyse genes per cell distribution}
\usage{
plot_genes_per_cell_distribution(
  gene_counts,
  plot_type = "hist",
  percentile_cutoffs = c(0.05, 0.95),
  return_suggestions = TRUE
)
}
\arguments{
\item{gene_counts}{A matrix of gene counts (rows = genes, columns = cells).
Supports both standard and sparse matrices from the Matrix package.}

\item{plot_type}{Character, one of "hist" (histogram) or "density" (density plot)}

\item{percentile_cutoffs}{Numeric vector of percentiles to show as cutoff lines}

\item{return_suggestions}{Logical, whether to return suggested QC parameters}
}
\value{
If return_suggestions=TRUE, returns a list containing:
\itemize{
\item min_genes_per_cell: Suggested minimum genes per cell
\item max_genes_per_cell: Suggested maximum genes per cell
\item median_genes: Median number of genes per cell
\item summary_stats: Additional statistics
}
}
\description{
Creates a detailed visualisation of genes per cell distribution and
calculates suggested quality control parameters. Optimised for both
dense and sparse matrices to accommodate large-scale single-cell datasets.
}
\examples{
# Load example data
data(gene_counts_blood)

# Create histogram plot with default settings
qc_suggestions <- plot_genes_per_cell_distribution(
  gene_counts = gene_counts_blood,
  plot_type = "hist",
  percentile_cutoffs = c(0.05, 0.95),
  return_suggestions = TRUE
)

# View QC suggestions
print(qc_suggestions$min_genes_per_cell)
print(qc_suggestions$max_genes_per_cell)

# Create density plot
plot_genes_per_cell_distribution(
  gene_counts = gene_counts_blood,
  plot_type = "density",
  percentile_cutoffs = c(0.1, 0.9),
  return_suggestions = FALSE
)

}
