% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualisation_analysis.R
\name{plot_isoform_profile}
\alias{plot_isoform_profile}
\title{Plot stacked isoform usage profiles}
\usage{
plot_isoform_profile(
  scht_obj,
  gene,
  cell_type_order = NULL,
  min_prop = 0.05,
  colour_palette = NULL
)
}
\arguments{
\item{scht_obj}{Single-Cell Hierarchical Tensor object}

\item{gene}{Gene name to analyse}

\item{cell_type_order}{Optional vector specifying the order of cell types}

\item{min_prop}{Minimum proportion to display (minor isoforms grouped as "Other")}

\item{colour_palette}{Colour palette to use (default: distinct qualitative palette)}
}
\value{
A ggplot object that can be printed or saved
}
\description{
Creates a stacked bar chart showing proportional isoform usage across
different cell types or developmental stages. This visualisation helps identify
cell type-specific isoform preferences.
}
\examples{
# Load example data and create SCHT
data(gene_counts_blood)
data(transcript_counts_blood)
data(transcript_info)
data(sample2stage)

scht_obj <- create_scht(
  gene_counts = gene_counts_blood,
  transcript_counts = transcript_counts_blood,
  transcript_info = transcript_info,
  cell_info = sample2stage,
  qc_params = list(
    min_genes_per_cell = 4000,       
    max_genes_per_cell = 10000,      
    min_cells_expressing = 0.02,   
    min_expr = 1e-6
  ),
  n_hvg = 3000,
  verbose = FALSE
)

# Example 1: Plot isoform profile for a gene with multiple isoforms
plot_isoform_profile(scht_obj, "Mapk13")

# Example 2: Specify cell type order
plot_isoform_profile(
  scht_obj, 
  "Atl1",
  cell_type_order = c("AEC", "HEC", "T1_pre_HSC", "T2_pre_HSC", 
                      "E12", "E14", "Adult_HSC")
)

# Example 3: Try another gene with error handling
tryCatch({
  plot_isoform_profile(scht_obj, "Irf8", min_prop = 0.03)
}, error = function(e) {
  print(paste("Error:", e$message))
})

}
